<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>WebSocket GPS Test</title>
  <style>
    body {
      font-family: sans-serif;
      padding: 1em;
      max-width: 600px;
    }
    label, input, button {
      margin: 0.3em 0;
      display: block;
    }
    .status {
      margin-top: 1em;
      font-weight: bold;
    }
  </style>
</head>
<body>
  <h1>WebSocket GPS Test</h1>

  <label>
    Server IP:
    <input id="ip" type="text" value="127.0.0.1" />
  </label>
  <button onclick="connectAll()">Connect</button>

  <div class="status" id="status-current">ðŸ›° /current: not connected</div>
  <div class="status" id="status-target">ðŸŽ¯ /target: not connected</div>

  <button onclick="sendCurrent()">Send Test /current</button>
  <button onclick="sendTarget()">Send Test /target</button>

  <script>
    let wsCurrent = null;
    let wsTarget = null;

    function connectAll() {
      const ip = document.getElementById("ip").value;

      wsCurrent = new WebSocket(`ws://${ip}:8765`);
      wsCurrent.onopen = () =>
        document.getElementById("status-current").innerText = "ðŸ›° /current: âœ… connected";
      wsCurrent.onerror = () =>
        document.getElementById("status-current").innerText = "ðŸ›° /current: âŒ error";
      wsCurrent.onclose = () =>
        document.getElementById("status-current").innerText = "ðŸ›° /current: ðŸ”Œ disconnected";

      wsTarget = new WebSocket(`ws://${ip}:8766`);
      wsTarget.onopen = () =>
        document.getElementById("status-target").innerText = "ðŸŽ¯ /target: âœ… connected";
      wsTarget.onerror = () =>
        document.getElementById("status-target").innerText = "ðŸŽ¯ /target: âŒ error";
      wsTarget.onclose = () =>
        document.getElementById("status-target").innerText = "ðŸŽ¯ /target: ðŸ”Œ disconnected";
    }

    function sendCurrent() {
      if (wsCurrent && wsCurrent.readyState === WebSocket.OPEN) {
        wsCurrent.send(JSON.stringify({
          latitude: 39.43217480068108,
          longitude: -76.63138368215046,
          declination: null
        }));
        alert("âœ… /current test data sent");
      } else {
        alert("ðŸ›° /current not connected!");
      }
    }

    function sendTarget() {
      if (wsTarget && wsTarget.readyState === WebSocket.OPEN) {
        wsTarget.send(JSON.stringify({
          latitude: 39.43290000000000,
          longitude: -76.63210000000000,
          declination: null
        }));
        alert("âœ… /target test data sent");
      } else {
        alert("ðŸŽ¯ /target not connected!");
      }
    }
  </script>
</body>
</html>
